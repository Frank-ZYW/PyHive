(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-736ea204"],{"44cd":function(t,e,n){"use strict";var s=n("dda6"),a=n.n(s);a.a},"7b3c":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel",attrs:{id:"project-index"}},[n("el-dialog",{staticClass:"dialog",attrs:{visible:t.createProjectDialog,size:"tiny",width:"400px"},on:{"update:visible":function(e){t.createProjectDialog=e}}},[n("el-tabs",{model:{value:t.activeDialogTab,callback:function(e){t.activeDialogTab=e},expression:"activeDialogTab"}},[n("el-tab-pane",{attrs:{label:t.$lang.columns.upload,name:"upload"}},[n("el-upload",{staticClass:"upload",attrs:{drag:"",accept:".zip",action:t.$store.state.url.project.upload}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v(t._s(t.$lang.messages.dragOrSelect))]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.$lang.messages.supportZip))])])],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.createProjectDialog=!1}}},[t._v("\n\t\t\t\t\t"+t._s(t.$lang.buttons.cancel)+"\n\t\t\t\t")]),"upload"===t.activeDialogTab?n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.onUploadedProject()}}},[t._v("\n\t\t\t\t\t"+t._s(t.$lang.buttons.finish)+"\n\t\t\t\t")]):t._e()],1)],1),n("el-dialog",{staticClass:"dialog",attrs:{visible:t.deployProjectDialog,size:"tiny",width:"1050px"},on:{"update:visible":function(e){t.deployProjectDialog=e}}},[n("div",{staticClass:"panel"},[n("panel-title",{attrs:{title:t.$lang.objects.clients}}),n("div",{staticClass:"panel-body"},[n("el-alert",{attrs:{title:t.$lang.messages.deployNotice,type:"warning"}}),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogLoading,expression:"dialogLoading"}],ref:"deployTable",attrs:{"empty-text":t.$lang.messages.noData,data:t.clients,"element-loading-text":t.$lang.messages.loading,"header-cell-class-name":t.headCellClass},on:{"row-click":t.handleSelectionChange}},[n("el-table-column",{attrs:{align:"center",type:"selection",selectable:t.checkSelectable,width:"55"}}),n("el-table-column",{attrs:{align:"center",label:t.$lang.columns.status,width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===t.clientsStatus[e.row.pk]?n("el-button",{attrs:{type:"success",size:"mini"}},[t._v(t._s(t.$lang.buttons.normal))]):0===t.clientsStatus[e.row.pk]?n("el-button",{attrs:{type:"warning",size:"mini"}},[t._v(t._s(t.$lang.buttons.connecting))]):n("el-button",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.$lang.buttons.error))])]}}])}),n("el-table-column",{attrs:{align:"center",prop:"pk",label:t.$lang.columns.id,width:"80"}}),n("el-table-column",{attrs:{align:"center",prop:"fields.name",label:t.$lang.columns.name,width:"200"}}),n("el-table-column",{attrs:{align:"center",prop:"fields.ip",label:t.$lang.columns.ip,width:"160"}}),n("el-table-column",{attrs:{align:"center",prop:"fields.port",label:t.$lang.columns.port,width:"150"}}),n("el-table-column",{attrs:{align:"center",prop:"fields.spider_amount",width:"130",label:t.$lang.columns.spiderAmount}})],1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){t.deployProjectDialog=!1}}},[t._v("\n\t\t\t\t\t"+t._s(t.$lang.buttons.cancel)+"\n\t\t\t\t")]),n("el-button",{attrs:{disabled:!t.ifChecked,type:"primary",size:"small"},on:{click:function(e){return t.onProjectDeploy()}}},[t._v("\n\t\t\t\t\t"+t._s(t.$lang.buttons.deploy)+"\n\t\t\t\t")])],1)]),n("panel-title",{attrs:{title:t.$lang.objects.project}},[n("el-input",{staticStyle:{width:"160px","margin-right":"10px"},attrs:{placeholder:t.$lang.inputs.search,"prefix-icon":"el-icon-search",size:"mini"},on:{input:t.getProjectData},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return e.stopPropagation(),t.onRefresh(e)}}},[n("i",{staticClass:"fa fa-refresh"}),t._v("\n\t\t\t\t"+t._s(t.$lang.buttons.refresh)+"\n\t\t\t")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.createProjectDialog=!0}}},[n("i",{staticClass:"fa fa-plus"}),t._v("\n\t\t\t\t"+t._s(t.$lang.buttons.createOrUpdate)+"\n\t\t\t")])],1),n("div",{staticClass:"panel-body"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],style:{width:"100%"},attrs:{data:t.projects,"empty-text":t.$lang.messages.noData,"element-loading-text":t.$lang.messages.loading,"max-height":"700"}},[n("el-table-column",{attrs:{align:"center",prop:"name",label:t.$lang.columns.name,width:"150"}}),n("el-table-column",{attrs:{align:"center",label:t.$lang.columns.deployedVersion,width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.client?n("span",[n("el-tag",{attrs:{type:"info",size:"medium"}},[t._v(t._s(e.row.deployed_version))]),n("span",{staticStyle:{"margin-left":"10px"}},[n("i",{staticClass:"fa fa-bug"}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$lang.tags.spiderAmount)+"\n\t\t\t\t\t\t\t\t"),n("el-badge",{staticClass:"mark",attrs:{value:e.row.spider_amount}})],1),n("el-divider",{attrs:{direction:"vertical"}}),n("span",{staticStyle:{color:"#909399"}},[n("i",{staticClass:"fa fa-clock-o",staticStyle:{"margin-right":"3px"}}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.row.deployed_at)+"\n\t\t\t\t\t\t\t")])],1):n("span",[t._v(t._s(t.$lang.messages.nullValue))])]}}])}),n("el-table-column",{attrs:{align:"center",label:t.$lang.columns.latestVersion,width:"350"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.uploaded_version))]),n("span",[e.row.if_built?n("el-tooltip",{attrs:{content:e.row.egg,placement:"top"}},[n("el-tag",{attrs:{size:"medium"}},[t._v(t._s(t.$lang.tags.built))])],1):n("el-tag",{attrs:{type:"danger",size:"medium"}},[t._v(t._s(t.$lang.tags.unBuild))])],1),n("el-divider",{attrs:{direction:"vertical"}}),n("span",{staticStyle:{color:"#909399"}},[n("i",{staticClass:"fa fa-clock-o",staticStyle:{"margin-right":"3px"}}),t._v("\n\t\t\t\t\t\t\t"+t._s(e.row.updated_at)+"\n\t\t\t\t\t\t")])]}}])}),n("el-table-column",{attrs:{align:"center",label:t.$lang.columns.client,width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("i",{staticClass:"el-icon-s-home",staticStyle:{"margin-right":"3px"}}),e.row.client?n("span",[t._v(t._s(e.row.client_name))]):n("span",[t._v(t._s(t.$lang.messages.nullValue))])]}}])}),n("el-table-column",{attrs:{align:"center",label:t.$lang.columns.operations},scopedSlots:t._u([{key:"default",fn:function(e){return[n("router-link",{attrs:{to:{name:"projectEdit",params:{name:e.row.name}},tag:"span"}},[n("el-button",{attrs:{type:"warning",size:"mini"}},[n("i",{staticClass:"fa fa-edit"}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.code)+"\n\t\t\t\t\t\t\t")])],1),n("el-dropdown",{attrs:{trigger:"click",size:"medium"}},[n("el-button",{attrs:{type:"primary",size:"mini"}},[n("i",{staticClass:"fa fa-cloud"}),t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.deployAction)+"\n\t\t\t\t\t\t\t\t"),n("i",{staticClass:"el-icon-arrow-down"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{disabled:!e.row.if_built},nativeOn:{click:function(n){return t.goProjectDeploy(e.row)}}},[n("i",{staticClass:"fa fa-cloud-upload"}),t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.deploy)+"\n\t\t\t\t\t\t\t\t")]),n("el-dropdown-item",{attrs:{disabled:!e.row.client},nativeOn:{click:function(n){return t.onSingleWithdraw(e.row.name)}}},[n("i",{staticClass:"fa fa-undo"}),t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.withdraw)+"\n\t\t\t\t\t\t\t\t")]),n("el-dropdown-item",{nativeOn:{click:function(n){return t.onProjectBuild(e.row.name)}}},[n("i",{staticClass:"fa fa-codepen"}),t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.build)+"\n\t\t\t\t\t\t\t\t")])],1)],1),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return t.onSingleDelete(e.row)}}},[n("i",{staticClass:"fa fa-remove"}),t._v("\n\t\t\t\t\t\t\t"+t._s(t.$lang.buttons.delete)+"\n\t\t\t\t\t\t")])]}}])})],1)],1)],1)},a=[],i=(n("ac6a"),n("7f7f"),n("eee4")),l={name:"ProjectIndex",data:function(){return{keyword:"",activeDialogTab:"upload",createProjectDialog:!1,deployProjectDialog:!1,gitAddress:null,projects:[],loading:!1,dialogLoading:!1,clients:null,clientsStatus:{},deployInfo:{},ifChecked:null}},components:{PanelTitle:i["a"]},created:function(){this.getProjectData()},methods:{getProjectData:function(){var t=this;this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.project.index,{keyword:this.keyword})).then(function(e){var n=e.data;t.projects=n,t.loading=!1}).catch(function(){t.loading=!1})},onRefresh:function(){this.getProjectData()},onDeleteProject:function(t){var e=this;this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.project.remove,{name:t})).then(function(){e.onRefresh(),e.$message.success(e.$store.getters.$lang.messages.successDelete)}).catch(function(){e.loading=!1,e.$message.error(e.$store.getters.$lang.messages.errorDelete)})},onSingleDelete:function(t){var e=this;t.client?this.$message.error(this.$store.getters.$lang.messages.withdrawFirst):this.$confirm(this.$store.getters.$lang.messages.confirm,this.$store.getters.$lang.buttons.confirm,{confirmButtonText:this.$store.getters.$lang.buttons.yes,cancelButtonText:this.$store.getters.$lang.buttons.no,type:"warning"}).then(function(){e.onDeleteProject(t.name)})},onUploadedProject:function(){this.createProjectDialog=!1,this.onRefresh()},onProjectWithdraw:function(t){var e=this;this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.project.withdraw,{name:t})).then(function(){e.onRefresh(),e.$message.success(e.$store.getters.$lang.messages.successWithdraw)}).catch(function(){e.loading=!1,e.$message.error(e.$store.getters.$lang.messages.errorWithdraw)})},onSingleWithdraw:function(t){var e=this;this.$confirm(this.$store.getters.$lang.messages.confirm,this.$store.getters.$lang.buttons.confirm,{confirmButtonText:this.$store.getters.$lang.buttons.yes,cancelButtonText:this.$store.getters.$lang.buttons.no,type:"warning"}).then(function(){e.onProjectWithdraw(t)})},onProjectBuild:function(t){var e=this;this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.project.build,{name:t})).then(function(){e.onRefresh(),e.$message.success(e.$store.getters.$lang.messages.successBuild)}).catch(function(){e.loading=!1,e.$message.error(e.$store.getters.$lang.messages.errorBuild)})},goProjectDeploy:function(t){var e=this;t.client?(this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.client.projectDeploy,{id:t.client,name:t.name})).then(function(){e.onRefresh(),e.$message.success(e.$store.getters.$lang.messages.successDeploy)}).catch(function(){e.loading=!1,e.$message.error(e.$store.getters.$lang.messages.errorDeploy)})):(this.ifChecked=!1,this.deployInfo.project=t.name,this.deployProjectDialog=!0,this.onGetClientData())},onProjectDeploy:function(){var t=this;this.deployProjectDialog=!1,this.loading=!0,this.$http.get(this.formatString(this.$store.state.url.client.projectDeploy,{id:this.deployInfo.client,name:this.deployInfo.project})).then(function(){t.onRefresh(),t.$message.success(t.$store.getters.$lang.messages.successDeploy)}).catch(function(){t.loading=!1,t.$message.error(t.$store.getters.$lang.messages.errorDeploy)})},onGetClientsStatus:function(){var t=this;this.clients.forEach(function(e){t.onGetClientStatus(e.pk)})},onGetClientStatus:function(t){var e=this;this.$set(this.clientsStatus,t,0),this.$http.get(this.formatString(this.$store.state.url.client.status,{id:t})).then(function(n){var s=n.data.result;e.$set(e.clientsStatus,t,parseInt(s))}).catch(function(){e.$set(e.clientsStatus,t,-1)})},onGetClientData:function(){var t=this;this.dialogLoading=!0,this.$http.get(this.$store.state.url.client.index).then(function(e){var n=e.data;t.clients=n,t.onGetClientsStatus(),t.dialogLoading=!1}).catch(function(){t.dialogLoading=!1})},handleSelectionChange:function(t){1===this.clientsStatus[t.pk]?(this.$refs.deployTable.clearSelection(),this.deployInfo.client===t.pk?(this.deployInfo.client=null,this.ifChecked=!1):(this.$refs.deployTable.toggleRowSelection(t),this.deployInfo.client=t.pk,this.ifChecked=!0)):this.$message.warning(this.$store.getters.$lang.messages.selectUnavailable)},checkSelectable:function(t){return 1===this.clientsStatus[t.pk]},headCellClass:function(t){if(0===t.columnIndex)return"disabledCheck"}}},o=l,r=(n("44cd"),n("2877")),c=Object(r["a"])(o,s,a,!1,null,null,null);e["default"]=c.exports},dda6:function(t,e,n){},eee4:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel-title"},[t.title?n("span",{domProps:{textContent:t._s(t.title)}}):t._e(),n("div",{staticClass:"fr"},[t._t("default")],2)])},a=[],i={name:"PanelTitle",props:{title:{type:String}}},l=i,o=n("2877"),r=Object(o["a"])(l,s,a,!1,null,null,null);e["a"]=r.exports}}]);
//# sourceMappingURL=chunk-736ea204.c84fa36d.js.map